
@model EliteRentals.Models.DTOs.RentalApplicationDto
@{
    ViewData["Title"] = "Manager â€¢ Applications";
    Layout = "_Layout";
}

<style>
  :root { --mgr-sidebar-w: 240px; }
  @@media (min-width: 768px) {
    .manager-main { margin-left: var(--mgr-sidebar-w); padding: 1.25rem 1.5rem; }
  }
</style>

<div class="container-fluid">
  <div class="row">
    @await Html.PartialAsync("_ManagerSidebar")

    <main class="manager-main col px-0">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="h4 m-0">Application #@Model.ApplicationId</h2>
        <div>
          <a asp-action="ManagerApplications" class="btn btn-sm btn-outline-secondary">Back</a>
          <a asp-action="AddLease" asp-route-propertyId="@Model.PropertyId" class="btn btn-sm btn-primary">Create Lease</a>
        </div>
      </div>

      <div class="card shadow-sm">
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-3">Applicant</dt>
            <dd class="col-sm-9">@Model.ApplicantName</dd>

            <dt class="col-sm-3">Email</dt>
            <dd class="col-sm-9">@Model.Email</dd>

            <dt class="col-sm-3">Phone</dt>
            <dd class="col-sm-9">@Model.Phone</dd>

            <dt class="col-sm-3">Property</dt>
            <dd class="col-sm-9">#@Model.PropertyId</dd>

            <dt class="col-sm-3">Status</dt>
            <dd class="col-sm-9">
              @{
                var approved = string.Equals(Model.Status,"Approved", System.StringComparison.OrdinalIgnoreCase);
                var rejected = string.Equals(Model.Status,"Rejected", System.StringComparison.OrdinalIgnoreCase);
                var badge = approved ? "bg-success" : (rejected ? "bg-danger" : "bg-warning text-dark");
              }
              <span class="badge @badge">@Model.Status</span>
            </dd>

            <dt class="col-sm-3">Submitted</dt>
            <dd class="col-sm-9">@Model.CreatedAt.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
          </dl>
        </div>
      </div>

      <div class="mt-3 d-flex gap-2">
        <form asp-action="UpdateApplicationStatus" method="post">
          @Html.AntiForgeryToken()
          <input type="hidden" name="id" value="@Model.ApplicationId" />
          <input type="hidden" name="status" value="Approved" />
          <button class="btn btn-success">Approve</button>
        </form>
        <form asp-action="UpdateApplicationStatus" method="post">
          @Html.AntiForgeryToken()
          <input type="hidden" name="id" value="@Model.ApplicationId" />
          <input type="hidden" name="status" value="Rejected" />
          <button class="btn btn-outline-danger">Reject</button>
        </form>
      </div>
    </main>
  </div>
</div>
