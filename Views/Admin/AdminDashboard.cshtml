@{
    ViewData["Title"] = "Admin Dashboard - EliteRentals";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="row">

        <!-- Sidebar -->
        @await Html.PartialAsync("_AdminSidebar")

        <!-- Main Content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">
            <div class="d-flex justify-content-between align-items-center pb-2 mb-3 border-bottom">
                <h2 class="h3">Admin Dashboard</h2>
                <div class="d-flex align-items-center">
                    <span class="me-2">Admin</span>
                    <img src="https://via.placeholder.com/40" class="rounded-circle" alt="Admin Avatar" />
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="row mb-4">
                <div class="col-md-3 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title text-muted">Occupancy Rate</h6>
                            <p class="display-6 text-success fw-bold">92%</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title text-muted">Overdue Payments</h6>
                            <p class="display-6 text-danger fw-bold">R35,000</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title text-muted">Active Maintenance</h6>
                            <p class="display-6 text-warning fw-bold">7</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title text-muted">Pending Requests</h6>
                            <p class="display-6 text-primary fw-bold">5</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="row mb-4">
                <div class="col-md-8 mb-3">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Rent Trends</h5>
                            <canvas id="rentTrendsChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Notifications</h5>
                            <ul class="list-group">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Overdue Invoices
                                    <span class="badge bg-danger">3 Unpaid</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Urgent Tasks
                                    <span class="badge bg-warning text-dark">5 Pending</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    New Tenant Requests
                                    <span class="badge bg-primary">2 New</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lease Expiration Timeline -->
            <div class="row mb-4">
                <div class="col-md-12 mb-3">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Lease Expiration Timeline</h5>
                            <canvas id="leaseExpirationChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions Table -->
            <div class="row">
                <div class="col-md-12">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title mb-3">Recent Activities</h5>
                            <table class="table table-hover align-middle">
                                <thead>
                                    <tr>
                                        <th>Tenant</th>
                                        <th>Property</th>
                                        <th>Action</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @for (int i = 1; i <= 6; i++)
                                    {
                                        <tr>
                                            <td>Tenant @i</td>
                                            <td>Property @i</td>
                                            <td>@(i % 2 == 0 ? "Payment Received" : "Maintenance Request")</td>
                                            <td>@DateTime.Now.AddDays(-i).ToString("dd/MM/yyyy")</td>
                                            <td>
                                                <span class="badge @(i % 2 == 0 ? "bg-success" : "bg-warning text-dark")">
                                                    @(i % 2 == 0 ? "Completed" : "Pending")
                                                </span>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Rent Trends Chart
        const rentCtx = document.getElementById('rentTrendsChart').getContext('2d');
        new Chart(rentCtx, {
            type: 'line',
            data: {
                labels: ['Jan','Feb','Mar','Apr','May','Jun'],
                datasets:[{
                    label:'Rent Collected',
                    data:[2000,2500,3000,3500,3200,4000],
                    borderColor:'#0d6efd',
                    backgroundColor:'rgba(13,110,253,0.2)',
                    fill:true,
                    tension:0.4
                }]
            }
        });

        // Lease Expiration Chart
        const leaseCtx = document.getElementById('leaseExpirationChart').getContext('2d');
        new Chart(leaseCtx,{
            type:'bar',
            data:{
                labels:['Jan','Feb','Mar','Apr','May','Jun'],
                datasets:[{
                    label:'Expiring Leases',
                    data:[2,5,3,8,4,6],
                    backgroundColor:'#ffc107'
                }]
            }
        });
    </script>
}
